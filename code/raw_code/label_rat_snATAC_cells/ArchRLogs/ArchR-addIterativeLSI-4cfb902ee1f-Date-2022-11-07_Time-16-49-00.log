
           ___      .______        ______  __    __  .______      
          /   \     |   _  \      /      ||  |  |  | |   _  \     
         /  ^  \    |  |_)  |    |  ,----'|  |__|  | |  |_)  |    
        /  /_\  \   |      /     |  |     |   __   | |      /     
       /  _____  \  |  |\  \\___ |  `----.|  |  |  | |  |\  \\___.
      /__/     \__\ | _| `._____| \______||__|  |__| | _| `._____|
    
Logging With ArchR!

Start Time : 2022-11-07 16:49:00

------- ArchR Info

ArchRThreads = 6

------- System Info

Computer OS = unix

------- Session Info

R version 4.1.3 (2022-03-10)
Platform: x86_64-conda-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

Matrix products: default
BLAS/LAPACK: /home/yixiaoz/anaconda3/envs/ArchR_Env/lib/libopenblasp-r0.3.21.so

Random number generation:
 RNG:     L'Ecuyer-CMRG 
 Normal:  Inversion 
 Sample:  Rejection 
 
locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats4    grid      stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] rhdf5_2.38.1                SummarizedExperiment_1.24.0
 [3] Biobase_2.54.0              MatrixGenerics_1.6.0       
 [5] Rcpp_1.0.9                  Matrix_1.5-1               
 [7] GenomicRanges_1.46.1        GenomeInfoDb_1.30.1        
 [9] IRanges_2.28.0              S4Vectors_0.32.4           
[11] BiocGenerics_0.40.0         matrixStats_0.62.0         
[13] data.table_1.14.2           stringr_1.4.1              
[15] plyr_1.8.7                  magrittr_2.0.3             
[17] ggplot2_3.3.6               gtable_0.3.1               
[19] gtools_3.9.3                gridExtra_2.3              
[21] ArchR_1.0.2                

loaded via a namespace (and not attached):
 [1] pbdZMQ_0.3-7           tidyselect_1.1.2       repr_1.1.4            
 [4] purrr_0.3.4            lattice_0.20-45        colorspace_2.0-3      
 [7] vctrs_0.4.2            generics_0.1.3         htmltools_0.5.3       
[10] base64enc_0.1-3        utf8_1.2.2             rlang_1.0.6           
[13] pillar_1.8.1           glue_1.6.2             withr_2.5.0           
[16] DBI_1.1.3              uuid_1.1-0             GenomeInfoDbData_1.2.7
[19] lifecycle_1.0.2        zlibbioc_1.40.0        munsell_0.5.0         
[22] evaluate_0.16          fastmap_1.1.0          parallel_4.1.3        
[25] fansi_1.0.3            IRdisplay_1.1          scales_1.2.1          
[28] DelayedArray_0.20.0    IRkernel_1.3           jsonlite_1.8.2        
[31] XVector_0.34.0         digest_0.6.29          stringi_1.7.8         
[34] dplyr_1.0.10           rhdf5filters_1.6.0     cli_3.4.1             
[37] tools_4.1.3            bitops_1.0-7           RCurl_1.98-1.8        
[40] tibble_3.1.8           crayon_1.5.2           pkgconfig_2.0.3       
[43] assertthat_0.2.1       Rhdf5lib_1.16.0        R6_2.5.1              
[46] compiler_4.1.3        


------- Log Info


2022-11-07 16:49:00 : IterativeLSI Input-Parameters, Class = list

IterativeLSI Input-Parameters$ArchRProj: length = 1

IterativeLSI Input-Parameters$useMatrix: length = 1
[1] "TileMatrix"


IterativeLSI Input-Parameters$name: length = 1
[1] "IterativeLSI200_ATAC"


IterativeLSI Input-Parameters$iterations: length = 1
[1] 4


IterativeLSI Input-Parameters$firstSelection: length = 1
[1] "top"


IterativeLSI Input-Parameters$depthCol: length = 1
[1] "nFrags"


IterativeLSI Input-Parameters$varFeatures: length = 1
[1] 2e+05


IterativeLSI Input-Parameters$dimsToUse: length = 30
[1] 1 2 3 4 5 6


IterativeLSI Input-Parameters$LSIMethod: length = 1
[1] 2


IterativeLSI Input-Parameters$scaleDims: length = 1
[1] TRUE


IterativeLSI Input-Parameters$corCutOff: length = 1
[1] 0.75


IterativeLSI Input-Parameters$binarize: length = 1
[1] TRUE


IterativeLSI Input-Parameters$outlierQuantiles: length = 2
[1] 0.02 0.98


IterativeLSI Input-Parameters$filterBias: length = 1
[1] TRUE


IterativeLSI Input-Parameters$sampleCellsPre: length = 1
[1] 10000


IterativeLSI Input-Parameters$projectCellsPre: length = 1
[1] FALSE


IterativeLSI Input-Parameters$sampleCellsFinal: length = 0
NULL


IterativeLSI Input-Parameters$selectionMethod: length = 1
[1] "var"


IterativeLSI Input-Parameters$scaleTo: length = 1
[1] 20000


IterativeLSI Input-Parameters$totalFeatures: length = 1
[1] 5e+05


IterativeLSI Input-Parameters$filterQuantile: length = 1
[1] 0.995


IterativeLSI Input-Parameters$excludeChr: length = 0
NULL


IterativeLSI Input-Parameters$saveIterations: length = 1
[1] TRUE


IterativeLSI Input-Parameters$nPlot: length = 1
[1] 10000


IterativeLSI Input-Parameters$outDir: length = 1
[1] "/projects/pfenninggroup/singleCell/Pierce_transgen_rat_multiome/data/tidy_data/ArchRProjects/Rat_Transgen_NAc_scATAC"


IterativeLSI Input-Parameters$threads: length = 1
[1] 6


IterativeLSI Input-Parameters$seed: length = 1
[1] 1


IterativeLSI Input-Parameters$verbose: length = 1
[1] TRUE


IterativeLSI Input-Parameters$force: length = 1
[1] FALSE


IterativeLSI Input-Parameters$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


2022-11-07 16:49:14 : Computing Total Across All Features, 0.134 mins elapsed.
2022-11-07 16:49:32 : Computing Top Features, 0.432 mins elapsed.
###########
2022-11-07 16:49:34 : Running LSI (1 of 4) on Top Features, 0.458 mins elapsed.
###########
2022-11-07 16:49:34 : Sampling Cells (N = 10003) for Estimated LSI, 0.459 mins elapsed.
2022-11-07 16:49:34 : Creating Sampled Partial Matrix, 0.459 mins elapsed.
2022-11-07 16:51:05 : Computing Estimated LSI (projectAll = FALSE), 1.983 mins elapsed.

2022-11-07 16:51:05 : LSI Parameters, Class = list

LSI Parameters$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


LSI Parameters$mat: nRows = 200000, nCols = 10003
LSI Parameters$mat: NonZeroEntries = 38168902, EntryRange = [ 1 , 1 ]
5 x 5 sparse Matrix of class "dgCMatrix"
     1S#AAACATGCACCTGTAA-1 1S#AAACATGCATCACAGC-1 1S#AAACATGCATGTTGCA-1
[1,]                     .                     .                     .
[2,]                     .                     .                     .
[3,]                     .                     .                     .
[4,]                     .                     .                     .
[5,]                     .                     .                     .
     1S#AAACCAACAACACCTA-1 1S#AAACCAACACCTATAG-1
[1,]                     .                     .
[2,]                     .                     .
[3,]                     .                     .
[4,]                     .                     .
[5,]                     .                     1


LSI Parameters$LSIMethod: length = 1
[1] 2


LSI Parameters$scaleTo: length = 1
[1] 20000


LSI Parameters$nDimensions: length = 1
[1] 30


LSI Parameters$binarize: length = 1
[1] TRUE


LSI Parameters$outlierQuantiles: length = 2
[1] 0.02 0.98


LSI Parameters$seed: length = 1
[1] 1


LSI Parameters$verbose: length = 1
[1] FALSE


LSI Parameters$tstart: length = 1
[1] "2022-11-07 16:49:06 EST"


LSI Parameters$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


2022-11-07 16:51:06 : Running LSI, Input Matrix = 0.459 GB, 1.995 mins elapsed.
2022-11-07 16:51:06 : Binarizing Matrix, 1.995 mins elapsed.
2022-11-07 16:51:07 : Computing Term Frequency, 2.016 mins elapsed.
2022-11-07 16:51:08 : Filtering Outliers Based On Counts, 2.02 mins elapsed.
2022-11-07 16:51:08 : Removing 0 Sum Rows, 2.034 mins elapsed.
2022-11-07 16:51:13 : Computing Inverse Document Frequency, 2.111 mins elapsed.
2022-11-07 16:51:16 : Computing SVD using irlba, 2.161 mins elapsed.
2022-11-07 16:56:09 : Projecting Outliers with LSI-Projection (Granja* et al 2019), 7.044 mins elapsed.

2022-11-07 16:56:09 : LSI-Projection Parameters, Class = list

LSI-Projection Parameters$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


LSI-Projection Parameters$mat: nRows = 200000, nCols = 50
LSI-Projection Parameters$mat: NonZeroEntries = 73654, EntryRange = [ 1 , 1 ]
5 x 5 sparse Matrix of class "dgCMatrix"
     1S#AAACATGCACCTGTAA-1 1S#AAACATGCATCACAGC-1 1S#AAACATGCATGTTGCA-1
[1,]                     .                     .                     .
[2,]                     .                     .                     .
[3,]                     .                     .                     .
[4,]                     .                     .                     .
[5,]                     .                     .                     .
     1S#AAACCAACAACACCTA-1 1S#AAACCAACACCTATAG-1
[1,]                     .                     .
[2,]                     .                     .
[3,]                     .                     .
[4,]                     .                     .
[5,]                     .                     1


LSI-Projection Parameters$matSVD: nRows = 9600, nCols = 30
                           LSI1        LSI2        LSI3        LSI4       LSI5
1S#AAACATGCACCTGTAA-1 -15.32186 -0.95345297  0.82505524 -1.33778877 -0.5928129
1S#AAACATGCATCACAGC-1 -23.55992 -0.42975216  1.57554911  0.29999852 -0.6877609
1S#AAACATGCATGTTGCA-1 -13.81086  0.22153722 -0.08598411 -0.76349489  0.3061135
1S#AAACCAACAACACCTA-1 -21.12417 -0.01198163 -1.86525530  0.06219449 -1.1081652
1S#AAACCAACACCTATAG-1 -12.47895 -0.04451405 -0.53195136 -0.29097298 -0.6757522


LSI-Projection Parameters$returnModel: length = 1
[1] FALSE


LSI-Projection Parameters$verbose: length = 1
[1] FALSE


LSI-Projection Parameters$tstart: length = 0
NULL


LSI-Projection Parameters$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


2022-11-07 16:56:09 : Projecting LSI, Input Matrix = 0.001 GB, 0 mins elapsed.
2022-11-07 16:56:09 : Subsetting by Non-Zero features in inital Matrix, 0 mins elapsed.
2022-11-07 16:56:09 : Binarizing Matrix, 0 mins elapsed.
2022-11-07 16:56:09 : Computing Term Frequency, 0 mins elapsed.
2022-11-07 16:56:09 : Computing Inverse Document Frequency, 0 mins elapsed.
2022-11-07 16:56:09 : Computing TF-IDF Matrix, 0 mins elapsed.
2022-11-07 16:56:10 : Calculating V Matrix, 0.009 mins elapsed.
2022-11-07 16:56:10 : Computing Projected Coordinates, 0.01 mins elapsed.

2022-11-07 16:56:10 : LSI-Projection Parameters, Class = list

LSI-Projection Parameters$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


LSI-Projection Parameters$mat: nRows = 200000, nCols = 403
LSI-Projection Parameters$mat: NonZeroEntries = 2868895, EntryRange = [ 1 , 1 ]
5 x 5 sparse Matrix of class "dgCMatrix"
     1S#AAATGCCTCCATAAGC-1 1S#AACATCATCACGTTAA-1 1S#AAGACATAGCGATAGA-1
[1,]                     .                     .                     .
[2,]                     .                     .                     .
[3,]                     .                     .                     .
[4,]                     .                     .                     .
[5,]                     .                     .                     .
     1S#AAGCAAGTCGTTAGTA-1 1S#AAGGATTAGCTGCACA-1
[1,]                     .                     .
[2,]                     .                     .
[3,]                     .                     .
[4,]                     .                     .
[5,]                     .                     .


LSI-Projection Parameters$matSVD: nRows = 9600, nCols = 30
                           LSI1        LSI2        LSI3        LSI4       LSI5
1S#AAACATGCACCTGTAA-1 -15.32186 -0.95345297  0.82505524 -1.33778877 -0.5928129
1S#AAACATGCATCACAGC-1 -23.55992 -0.42975216  1.57554911  0.29999852 -0.6877609
1S#AAACATGCATGTTGCA-1 -13.81086  0.22153722 -0.08598411 -0.76349489  0.3061135
1S#AAACCAACAACACCTA-1 -21.12417 -0.01198163 -1.86525530  0.06219449 -1.1081652
1S#AAACCAACACCTATAG-1 -12.47895 -0.04451405 -0.53195136 -0.29097298 -0.6757522


LSI-Projection Parameters$returnModel: length = 1
[1] FALSE


LSI-Projection Parameters$verbose: length = 1
[1] FALSE


LSI-Projection Parameters$tstart: length = 0
NULL


LSI-Projection Parameters$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


2022-11-07 16:56:10 : Projecting LSI, Input Matrix = 0.034 GB, 0 mins elapsed.
2022-11-07 16:56:10 : Subsetting by Non-Zero features in inital Matrix, 0 mins elapsed.
2022-11-07 16:56:10 : Binarizing Matrix, 0.001 mins elapsed.
2022-11-07 16:56:10 : Computing Term Frequency, 0.002 mins elapsed.
2022-11-07 16:56:10 : Computing Inverse Document Frequency, 0.002 mins elapsed.
2022-11-07 16:56:10 : Computing TF-IDF Matrix, 0.002 mins elapsed.
2022-11-07 16:56:10 : Calculating V Matrix, 0.014 mins elapsed.
2022-11-07 16:56:11 : Computing Projected Coordinates, 0.019 mins elapsed.
2022-11-07 16:56:11 : Finished LSI (TF-IDF SVD) using irlba, 7.075 mins elapsed.

2022-11-07 16:56:12 : outLSI-1, Class = SimpleList

outLSI-1$matSVD: nRows = 10003, nCols = 30
                           LSI1        LSI2        LSI3        LSI4       LSI5
1S#AAACATGCACCTGTAA-1 -15.32186 -0.95345297  0.82505524 -1.33778877 -0.5928129
1S#AAACATGCATCACAGC-1 -23.55992 -0.42975216  1.57554911  0.29999852 -0.6877609
1S#AAACATGCATGTTGCA-1 -13.81086  0.22153722 -0.08598411 -0.76349489  0.3061135
1S#AAACCAACAACACCTA-1 -21.12417 -0.01198163 -1.86525530  0.06219449 -1.1081652
1S#AAACCAACACCTATAG-1 -12.47895 -0.04451405 -0.53195136 -0.29097298 -0.6757522


outLSI-1$rowSm: length = 200000
[1] 203 414 107 205 528 317


outLSI-1$nCol: length = 1
[1] 9600


outLSI-1$exclude: length = 0
NULL


outLSI-1$idx: length = 200000
[1] 1 2 3 4 5 6


outLSI-1$u: nRows = 200000, nCols = 30
             [,1]         [,2]          [,3]          [,4]          [,5]
[1,] -0.002306568 -0.002225317  0.0020273902 -3.053518e-03 -0.0023929784
[2,] -0.003988991 -0.004701987  0.0066990698 -2.642425e-05 -0.0048023572
[3,] -0.001488840  0.002251916  0.0008326363 -2.514894e-04 -0.0036194087
[4,] -0.002428257 -0.000742401 -0.0027463442  4.101074e-03  0.0023367644
[5,] -0.004966953 -0.005061530  0.0038280309  6.456591e-03  0.0003580994


outLSI-1$v: nRows = 9600, nCols = 30
             [,1]          [,2]          [,3]          [,4]          [,5]
[1,] -0.002765787 -8.881684e-04  0.0012350187 -0.0023487270 -0.0010750593
[2,] -0.004252860 -4.003263e-04  0.0023584270  0.0005267010 -0.0012472464
[3,] -0.002493033  2.063682e-04 -0.0001287089 -0.0013404515  0.0005551332
[4,] -0.003813177 -1.116123e-05 -0.0027920859  0.0001091935 -0.0020096446
[5,] -0.002252606 -4.146610e-05 -0.0007962738 -0.0005108550 -0.0012254686


outLSI-1$binarize: length = 1
[1] TRUE


outLSI-1$scaleTo: length = 1
[1] 20000


outLSI-1$nDimensions: length = 1
[1] 30


outLSI-1$LSIMethod: length = 1
[1] 2


outLSI-1$outliers: length = 403
[1] "1S#AAATGCCTCCATAAGC-1" "1S#AACATCATCACGTTAA-1" "1S#AAGACATAGCGATAGA-1"
[4] "1S#AAGCAAGTCGTTAGTA-1" "1S#AAGGATTAGCTGCACA-1" "1S#AAGGTATAGCTCCTTA-1"


outLSI-1$date: length = 1
[1] "2022-11-07"


outLSI-1$seed: length = 1
[1] 1


outLSI-1$scaleDims: length = 1
[1] TRUE


outLSI-1$useMatrix: length = 1
[1] "TileMatrix"


outLSI-1$tileSize: length = 1
[1] 500



2022-11-07 16:56:12 : Cluster Params, Class = list

Cluster Params$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


Cluster Params$matSVD: nRows = 10003, nCols = 30
                           LSI1        LSI2        LSI3        LSI4       LSI5
1S#AAACATGCACCTGTAA-1 -15.32186 -0.95345297  0.82505524 -1.33778877 -0.5928129
1S#AAACATGCATCACAGC-1 -23.55992 -0.42975216  1.57554911  0.29999852 -0.6877609
1S#AAACATGCATGTTGCA-1 -13.81086  0.22153722 -0.08598411 -0.76349489  0.3061135
1S#AAACCAACAACACCTA-1 -21.12417 -0.01198163 -1.86525530  0.06219449 -1.1081652
1S#AAACCAACACCTATAG-1 -12.47895 -0.04451405 -0.53195136 -0.29097298 -0.6757522


Cluster Params$corCutOff: length = 1
[1] 0.75


Cluster Params$dimsToUse: length = 30
[1] 1 2 3 4 5 6


Cluster Params$scaleDims: length = 1
[1] TRUE


Cluster Params$verbose: length = 1
[1] TRUE


Cluster Params$j: length = 1
[1] 1


Cluster Params$filterBias: length = 1
[1] TRUE


Cluster Params$cellNames: length = 43786
[1] "1S#AGAAGGTGTTGTTCAC-1" "1S#AAGCCTGTCTTAGGGT-1" "1S#TAATGGTGTCATGCAA-1"
[4] "1S#ACTTGAATCGGTTCCT-1" "1S#GGCTTCAAGCAAACCT-1" "1S#TAGGCTTAGGAGCATA-1"


Cluster Params$cellDepth: length = 43786
1S#AGAAGGTGTTGTTCAC-1 1S#AAGCCTGTCTTAGGGT-1 1S#TAATGGTGTCATGCAA-1 
             4.997448              4.993114              4.985853 
1S#ACTTGAATCGGTTCCT-1 1S#GGCTTCAAGCAAACCT-1 1S#TAGGCTTAGGAGCATA-1 
             4.980140              4.973599              4.967576 


Cluster Params$tstart: length = 1
[1] "2022-11-07 16:49:06 EST"


Cluster Params$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


2022-11-07 16:56:12 : Identifying Clusters, 7.098 mins elapsed.

2022-11-07 16:56:12 : addClusters Input-Parameters, Class = list

addClusters Input-Parameters$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


addClusters Input-Parameters$input: nRows = 10003, nCols = 30
                           LSI1       LSI2        LSI3       LSI4        LSI5
1S#AAACATGCACCTGTAA-1 -5.124469 -0.1567209  0.45818243 -0.2896016 -0.03203283
1S#AAACATGCATCACAGC-1 -5.215216  0.1108399  0.57258954  0.2788756  0.05142968
1S#AAACATGCATGTTGCA-1 -5.156501  0.2572808  0.13863729 -0.1227503  0.28991081
1S#AAACCAACAACACCTA-1 -5.187616  0.2138417 -0.26030991  0.2328193 -0.06661187
1S#AAACCAACACCTATAG-1 -5.125510  0.2293831  0.01946804  0.1232455 -0.04245982


addClusters Input-Parameters$reducedDims: length = 1
[1] "IterativeLSI"


addClusters Input-Parameters$name: length = 1
[1] "Clusters"


addClusters Input-Parameters$sampleCells: length = 1
[1] 10000


addClusters Input-Parameters$seed: length = 1
[1] 1


addClusters Input-Parameters$method: length = 1
[1] "Seurat"


addClusters Input-Parameters$dimsToUse: length = 0
NULL


addClusters Input-Parameters$scaleDims: length = 0
NULL


addClusters Input-Parameters$corCutOff: length = 1
[1] 0.75


addClusters Input-Parameters$knnAssign: length = 1
[1] 10


addClusters Input-Parameters$nOutlier: length = 1
[1] 5


addClusters Input-Parameters$maxClusters: length = 1
[1] 25


addClusters Input-Parameters$testBias: length = 1
[1] TRUE


addClusters Input-Parameters$filterBias: length = 1
[1] TRUE


addClusters Input-Parameters$biasClusters: length = 1
[1] 0.01


addClusters Input-Parameters$biasCol: length = 1
[1] "nFrags"


addClusters Input-Parameters$biasVals: length = 10003
[1] 3.614370 3.853394 3.540705 3.846151 3.533391 3.738384


addClusters Input-Parameters$biasQuantiles: length = 2
[1] 0.05 0.95


addClusters Input-Parameters$biasEnrich: length = 1
[1] 10


addClusters Input-Parameters$biasProportion: length = 1
[1] 0.5


addClusters Input-Parameters$biasPval: length = 1
[1] 0.05


addClusters Input-Parameters$nPerm: length = 1
[1] 500


addClusters Input-Parameters$prefix: length = 1
[1] "C"


addClusters Input-Parameters$ArchRProj: length = 0
NULL


addClusters Input-Parameters$verbose: length = 1
[1] FALSE


addClusters Input-Parameters$tstart: length = 0
NULL


addClusters Input-Parameters$force: length = 1
[1] FALSE


addClusters Input-Parameters$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


addClusters Input-Parameters$...: length = 2

2022-11-07 16:56:12 : Estimating Clusters by Sampling, 0 mins elapsed.
2022-11-07 16:56:22 : Running Seurats FindClusters (Stuart et al. Cell 2019), 0.163 mins elapsed.
2022-11-07 16:56:47 : Finding Nearest Clusters, 0.575 mins elapsed.
2022-11-07 16:56:47 : Assigning Nearest Clusters, 0.584 mins elapsed.
2022-11-07 16:56:48 : Testing Outlier Clusters, 0.597 mins elapsed.
2022-11-07 16:56:48 : Assigning Cluster Names to 6 Clusters, 0.597 mins elapsed.
2022-11-07 16:56:48 : Finished addClusters, 0.597 mins elapsed.
2022-11-07 16:56:48 : Identified 6 Clusters, 7.697 mins elapsed.

2022-11-07 16:56:48 : clusterDF-1, Class = DFrame
DataFrame with 10003 rows and 2 columns
                  cellNames    clusters
                <character> <character>
1     1S#AAACATGCACCTGTAA-1          C2
2     1S#AAACATGCATCACAGC-1          C3
3     1S#AAACATGCATGTTGCA-1          C2
4     1S#AAACCAACAACACCTA-1          C2
5     1S#AAACCAACACCTATAG-1          C2
...                     ...         ...
9999  5M#TTTGTGGCAATTAACC-1          C6
10000 5M#TTTGTGGCAGGGAGGA-1          C5
10001 5M#TTTGTGGCATAAACCT-1          C3
10002 5M#TTTGTTGGTGGTTCTT-1          C3
10003 5M#TTTGTTGGTTGTTGTC-1          C1

2022-11-07 16:56:48 : Saving LSI Iteration, 7.698 mins elapsed.

2022-11-07 16:56:48 : Save iteration, Class = list

Save iteration$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


Save iteration$matSVD: nRows = 10003, nCols = 30
                           LSI1        LSI2        LSI3        LSI4       LSI5
1S#AAACATGCACCTGTAA-1 -15.32186 -0.95345297  0.82505524 -1.33778877 -0.5928129
1S#AAACATGCATCACAGC-1 -23.55992 -0.42975216  1.57554911  0.29999852 -0.6877609
1S#AAACATGCATGTTGCA-1 -13.81086  0.22153722 -0.08598411 -0.76349489  0.3061135
1S#AAACCAACAACACCTA-1 -21.12417 -0.01198163 -1.86525530  0.06219449 -1.1081652
1S#AAACCAACACCTATAG-1 -12.47895 -0.04451405 -0.53195136 -0.29097298 -0.6757522


Save iteration$clusters: length = 10003
[1] "C2" "C3" "C2" "C2" "C2" "C2"


Save iteration$nPlot: length = 1
[1] 10000


Save iteration$ArchRProj: length = 1

Save iteration$scaleDims: length = 1
[1] TRUE


Save iteration$corCutOff: length = 1
[1] 0.75


Save iteration$dimsToUse: length = 30
[1] 1 2 3 4 5 6


Save iteration$j: length = 1
[1] 1


Save iteration$threads: length = 1
[1] 6


Save iteration$outDir: length = 1
[1] "/projects/pfenninggroup/singleCell/Pierce_transgen_rat_multiome/data/tidy_data/ArchRProjects/Rat_Transgen_NAc_scATAC/IterativeLSI200_ATAC"


Save iteration$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


2022-11-07 16:57:19 : Creating Cluster Matrix on the total Group Features, 8.207 mins elapsed.
2022-11-07 16:59:12 : Computing Variable Features, 10.087 mins elapsed.
###########
2022-11-07 16:59:12 : Running LSI (2 of 4) on Variable Features, 10.093 mins elapsed.
###########
2022-11-07 16:59:12 : Sampling Cells (N = 10003) for Estimated LSI, 10.094 mins elapsed.
2022-11-07 16:59:12 : Creating Sampled Partial Matrix, 10.094 mins elapsed.
2022-11-07 17:00:43 : Computing Estimated LSI (projectAll = FALSE), 11.608 mins elapsed.

2022-11-07 17:00:43 : LSI Parameters, Class = list

LSI Parameters$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


LSI Parameters$mat: nRows = 200000, nCols = 10003
LSI Parameters$mat: NonZeroEntries = 36318020, EntryRange = [ 1 , 1 ]
5 x 5 sparse Matrix of class "dgCMatrix"
     1S#AAACAGCCAGTTTGGC-1 1S#AAACCAACACAACCTA-1 1S#AAACCAACACCTATAG-1
[1,]                     .                     .                     .
[2,]                     .                     .                     .
[3,]                     .                     .                     .
[4,]                     .                     .                     .
[5,]                     .                     .                     1
     1S#AAACCGAAGCTCCTTA-1 1S#AAACCGAAGTCTCACC-1
[1,]                     1                     .
[2,]                     .                     .
[3,]                     .                     .
[4,]                     .                     .
[5,]                     .                     .


LSI Parameters$LSIMethod: length = 1
[1] 2


LSI Parameters$scaleTo: length = 1
[1] 20000


LSI Parameters$nDimensions: length = 1
[1] 30


LSI Parameters$binarize: length = 1
[1] TRUE


LSI Parameters$outlierQuantiles: length = 2
[1] 0.02 0.98


LSI Parameters$seed: length = 1
[1] 1


LSI Parameters$verbose: length = 1
[1] FALSE


LSI Parameters$tstart: length = 1
[1] "2022-11-07 16:49:06 EST"


LSI Parameters$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


2022-11-07 17:00:44 : Running LSI, Input Matrix = 0.437 GB, 11.632 mins elapsed.
2022-11-07 17:00:44 : Binarizing Matrix, 11.632 mins elapsed.
2022-11-07 17:00:45 : Computing Term Frequency, 11.644 mins elapsed.
2022-11-07 17:00:45 : Filtering Outliers Based On Counts, 11.648 mins elapsed.
2022-11-07 17:00:46 : Removing 0 Sum Rows, 11.663 mins elapsed.
2022-11-07 17:00:50 : Computing Inverse Document Frequency, 11.729 mins elapsed.
2022-11-07 17:00:53 : Computing SVD using irlba, 11.781 mins elapsed.
2022-11-07 17:05:04 : Projecting Outliers with LSI-Projection (Granja* et al 2019), 15.96 mins elapsed.

2022-11-07 17:05:04 : LSI-Projection Parameters, Class = list

LSI-Projection Parameters$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


LSI-Projection Parameters$mat: nRows = 200000, nCols = 50
LSI-Projection Parameters$mat: NonZeroEntries = 59443, EntryRange = [ 1 , 1 ]
5 x 5 sparse Matrix of class "dgCMatrix"
     1S#AAACAGCCAGTTTGGC-1 1S#AAACCAACACAACCTA-1 1S#AAACCAACACCTATAG-1
[1,]                     .                     .                     .
[2,]                     .                     .                     .
[3,]                     .                     .                     .
[4,]                     .                     .                     .
[5,]                     .                     .                     1
     1S#AAACCGAAGCTCCTTA-1 1S#AAACCGAAGTCTCACC-1
[1,]                     1                     .
[2,]                     .                     .
[3,]                     .                     .
[4,]                     .                     .
[5,]                     .                     .


LSI-Projection Parameters$matSVD: nRows = 9599, nCols = 30
                           LSI1        LSI2       LSI3       LSI4       LSI5
1S#AAACAGCCAGTTTGGC-1 -42.87428 -5.41183352 -4.4779968  0.3131089 -0.8341912
1S#AAACCAACACAACCTA-1 -20.56117  1.71461664  0.7080832 -0.7015296  1.2719265
1S#AAACCAACACCTATAG-1 -12.74008 -0.01721717  0.7608353 -0.4877413  1.0434432
1S#AAACCGAAGCTCCTTA-1 -57.28733 -6.63095081  7.3652403 -7.3549629  5.1005021
1S#AAACCGAAGTCTCACC-1 -12.46349 -0.20085113 -0.5542908  0.1009002  0.2384819


LSI-Projection Parameters$returnModel: length = 1
[1] FALSE


LSI-Projection Parameters$verbose: length = 1
[1] FALSE


LSI-Projection Parameters$tstart: length = 0
NULL


LSI-Projection Parameters$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


2022-11-07 17:05:04 : Projecting LSI, Input Matrix = 0.001 GB, 0 mins elapsed.
2022-11-07 17:05:04 : Subsetting by Non-Zero features in inital Matrix, 0 mins elapsed.
2022-11-07 17:05:04 : Binarizing Matrix, 0 mins elapsed.
2022-11-07 17:05:04 : Computing Term Frequency, 0 mins elapsed.
2022-11-07 17:05:04 : Computing Inverse Document Frequency, 0 mins elapsed.
2022-11-07 17:05:04 : Computing TF-IDF Matrix, 0 mins elapsed.
2022-11-07 17:05:05 : Calculating V Matrix, 0.012 mins elapsed.
2022-11-07 17:05:05 : Computing Projected Coordinates, 0.013 mins elapsed.

2022-11-07 17:05:05 : LSI-Projection Parameters, Class = list

LSI-Projection Parameters$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


LSI-Projection Parameters$mat: nRows = 200000, nCols = 404
LSI-Projection Parameters$mat: NonZeroEntries = 2714261, EntryRange = [ 1 , 1 ]
5 x 5 sparse Matrix of class "dgCMatrix"
     1S#AAACGCGCAATTGCGC-1 1S#AAAGGAGCAGGCCATT-1 1S#AAAGGCTCAACTAGAA-1
[1,]                     .                     .                     .
[2,]                     .                     .                     .
[3,]                     .                     .                     .
[4,]                     .                     .                     .
[5,]                     .                     .                     .
     1S#AACATCATCACGTTAA-1 1S#AACCTTGCAGGGAGCT-1
[1,]                     .                     .
[2,]                     .                     .
[3,]                     .                     .
[4,]                     .                     .
[5,]                     .                     .


LSI-Projection Parameters$matSVD: nRows = 9599, nCols = 30
                           LSI1        LSI2       LSI3       LSI4       LSI5
1S#AAACAGCCAGTTTGGC-1 -42.87428 -5.41183352 -4.4779968  0.3131089 -0.8341912
1S#AAACCAACACAACCTA-1 -20.56117  1.71461664  0.7080832 -0.7015296  1.2719265
1S#AAACCAACACCTATAG-1 -12.74008 -0.01721717  0.7608353 -0.4877413  1.0434432
1S#AAACCGAAGCTCCTTA-1 -57.28733 -6.63095081  7.3652403 -7.3549629  5.1005021
1S#AAACCGAAGTCTCACC-1 -12.46349 -0.20085113 -0.5542908  0.1009002  0.2384819


LSI-Projection Parameters$returnModel: length = 1
[1] FALSE


LSI-Projection Parameters$verbose: length = 1
[1] FALSE


LSI-Projection Parameters$tstart: length = 0
NULL


LSI-Projection Parameters$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


2022-11-07 17:05:05 : Projecting LSI, Input Matrix = 0.033 GB, 0 mins elapsed.
2022-11-07 17:05:05 : Subsetting by Non-Zero features in inital Matrix, 0 mins elapsed.
2022-11-07 17:05:05 : Binarizing Matrix, 0.001 mins elapsed.
2022-11-07 17:05:05 : Computing Term Frequency, 0.002 mins elapsed.
2022-11-07 17:05:05 : Computing Inverse Document Frequency, 0.003 mins elapsed.
2022-11-07 17:05:05 : Computing TF-IDF Matrix, 0.003 mins elapsed.
2022-11-07 17:05:06 : Calculating V Matrix, 0.017 mins elapsed.
2022-11-07 17:05:06 : Computing Projected Coordinates, 0.022 mins elapsed.
2022-11-07 17:05:06 : Finished LSI (TF-IDF SVD) using irlba, 15.998 mins elapsed.

2022-11-07 17:05:07 : outLSI-2, Class = SimpleList

outLSI-2$matSVD: nRows = 10003, nCols = 30
                           LSI1        LSI2       LSI3       LSI4       LSI5
1S#AAACAGCCAGTTTGGC-1 -42.87428 -5.41183352 -4.4779968  0.3131089 -0.8341912
1S#AAACCAACACAACCTA-1 -20.56117  1.71461664  0.7080832 -0.7015296  1.2719265
1S#AAACCAACACCTATAG-1 -12.74008 -0.01721717  0.7608353 -0.4877413  1.0434432
1S#AAACCGAAGCTCCTTA-1 -57.28733 -6.63095081  7.3652403 -7.3549629  5.1005021
1S#AAACCGAAGTCTCACC-1 -12.46349 -0.20085113 -0.5542908  0.1009002  0.2384819


outLSI-2$rowSm: length = 200000
[1] 183 478  90 179 495 107


outLSI-2$nCol: length = 1
[1] 9599


outLSI-2$exclude: length = 0
NULL


outLSI-2$idx: length = 200000
[1] 1 2 3 4 5 6


outLSI-2$u: nRows = 200000, nCols = 30
             [,1]          [,2]          [,3]          [,4]          [,5]
[1,] -0.002148630  0.0007406175  0.0007344996 -0.0025689298  0.0013260232
[2,] -0.004567678  0.0025542315 -0.0037655391  0.0013880326  0.0005327839
[3,] -0.001252972 -0.0006400536 -0.0015053284 -0.0022723804  0.0011335011
[4,] -0.002138776  0.0017049824 -0.0006228016  0.0004634858 -0.0013219089
[5,] -0.004764361  0.0031695059 -0.0017904981  0.0032312513 -0.0010752436


outLSI-2$v: nRows = 9599, nCols = 30
             [,1]          [,2]          [,3]          [,4]          [,5]
[1,] -0.007737934 -4.820334e-03 -0.0064827640  0.0005283122 -0.0014746657
[2,] -0.003710872  1.527213e-03  0.0010250870 -0.0011836989  0.0022484851
[3,] -0.002299324 -1.533538e-05  0.0011014559 -0.0008229714  0.0018445772
[4,] -0.010339194 -5.906205e-03  0.0106626059 -0.0124101124  0.0090165613
[5,] -0.002249405 -1.788986e-04 -0.0008024428  0.0001702500  0.0004215833


outLSI-2$binarize: length = 1
[1] TRUE


outLSI-2$scaleTo: length = 1
[1] 20000


outLSI-2$nDimensions: length = 1
[1] 30


outLSI-2$LSIMethod: length = 1
[1] 2


outLSI-2$outliers: length = 404
[1] "1S#AAACGCGCAATTGCGC-1" "1S#AAAGGAGCAGGCCATT-1" "1S#AAAGGCTCAACTAGAA-1"
[4] "1S#AACATCATCACGTTAA-1" "1S#AACCTTGCAGGGAGCT-1" "1S#AAGACCAAGGCGCTTA-1"


outLSI-2$date: length = 1
[1] "2022-11-07"


outLSI-2$seed: length = 1
[1] 1


outLSI-2$scaleDims: length = 1
[1] TRUE


outLSI-2$useMatrix: length = 1
[1] "TileMatrix"


outLSI-2$tileSize: length = 1
[1] 500



2022-11-07 17:05:07 : Cluster Params, Class = list

Cluster Params$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


Cluster Params$matSVD: nRows = 10003, nCols = 30
                           LSI1        LSI2       LSI3       LSI4       LSI5
1S#AAACAGCCAGTTTGGC-1 -42.87428 -5.41183352 -4.4779968  0.3131089 -0.8341912
1S#AAACCAACACAACCTA-1 -20.56117  1.71461664  0.7080832 -0.7015296  1.2719265
1S#AAACCAACACCTATAG-1 -12.74008 -0.01721717  0.7608353 -0.4877413  1.0434432
1S#AAACCGAAGCTCCTTA-1 -57.28733 -6.63095081  7.3652403 -7.3549629  5.1005021
1S#AAACCGAAGTCTCACC-1 -12.46349 -0.20085113 -0.5542908  0.1009002  0.2384819


Cluster Params$corCutOff: length = 1
[1] 0.75


Cluster Params$dimsToUse: length = 30
[1] 1 2 3 4 5 6


Cluster Params$scaleDims: length = 1
[1] TRUE


Cluster Params$verbose: length = 1
[1] TRUE


Cluster Params$j: length = 1
[1] 2


Cluster Params$filterBias: length = 1
[1] TRUE


Cluster Params$cellNames: length = 43786
[1] "1S#AGAAGGTGTTGTTCAC-1" "1S#AAGCCTGTCTTAGGGT-1" "1S#TAATGGTGTCATGCAA-1"
[4] "1S#ACTTGAATCGGTTCCT-1" "1S#GGCTTCAAGCAAACCT-1" "1S#TAGGCTTAGGAGCATA-1"


Cluster Params$cellDepth: length = 43786
1S#AGAAGGTGTTGTTCAC-1 1S#AAGCCTGTCTTAGGGT-1 1S#TAATGGTGTCATGCAA-1 
             4.997448              4.993114              4.985853 
1S#ACTTGAATCGGTTCCT-1 1S#GGCTTCAAGCAAACCT-1 1S#TAGGCTTAGGAGCATA-1 
             4.980140              4.973599              4.967576 


Cluster Params$tstart: length = 1
[1] "2022-11-07 16:49:06 EST"


Cluster Params$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


2022-11-07 17:05:07 : Identifying Clusters, 16.013 mins elapsed.

2022-11-07 17:05:07 : addClusters Input-Parameters, Class = list

addClusters Input-Parameters$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


addClusters Input-Parameters$input: nRows = 10003, nCols = 30
                           LSI1        LSI2        LSI3        LSI4      LSI5
1S#AAACAGCCAGTTTGGC-1 -5.159297 -0.42870952 -0.31078888  0.29421006 0.1493343
1S#AAACCAACACAACCTA-1 -5.217492  0.54735068  0.28686579 -0.07793367 0.4327851
1S#AAACCAACACCTATAG-1 -5.141809  0.14965010  0.47324352 -0.04604172 0.5907807
1S#AAACCGAAGCTCCTTA-1 -5.064041 -0.49200321  0.77123574 -0.55734957 0.5668297
1S#AAACCGAAGTCTCACC-1 -5.136661  0.09501084 -0.05577895  0.22374856 0.2824458


addClusters Input-Parameters$reducedDims: length = 1
[1] "IterativeLSI"


addClusters Input-Parameters$name: length = 1
[1] "Clusters"


addClusters Input-Parameters$sampleCells: length = 1
[1] 10000


addClusters Input-Parameters$seed: length = 1
[1] 1


addClusters Input-Parameters$method: length = 1
[1] "Seurat"


addClusters Input-Parameters$dimsToUse: length = 0
NULL


addClusters Input-Parameters$scaleDims: length = 0
NULL


addClusters Input-Parameters$corCutOff: length = 1
[1] 0.75


addClusters Input-Parameters$knnAssign: length = 1
[1] 10


addClusters Input-Parameters$nOutlier: length = 1
[1] 5


addClusters Input-Parameters$maxClusters: length = 1
[1] 25


addClusters Input-Parameters$testBias: length = 1
[1] TRUE


addClusters Input-Parameters$filterBias: length = 1
[1] TRUE


addClusters Input-Parameters$biasClusters: length = 1
[1] 0.01


addClusters Input-Parameters$biasCol: length = 1
[1] "nFrags"


addClusters Input-Parameters$biasVals: length = 10003
[1] 4.068965 3.796019 3.533391 4.494600 3.505286 3.622214


addClusters Input-Parameters$biasQuantiles: length = 2
[1] 0.05 0.95


addClusters Input-Parameters$biasEnrich: length = 1
[1] 10


addClusters Input-Parameters$biasProportion: length = 1
[1] 0.5


addClusters Input-Parameters$biasPval: length = 1
[1] 0.05


addClusters Input-Parameters$nPerm: length = 1
[1] 500


addClusters Input-Parameters$prefix: length = 1
[1] "C"


addClusters Input-Parameters$ArchRProj: length = 0
NULL


addClusters Input-Parameters$verbose: length = 1
[1] FALSE


addClusters Input-Parameters$tstart: length = 0
NULL


addClusters Input-Parameters$force: length = 1
[1] FALSE


addClusters Input-Parameters$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


addClusters Input-Parameters$...: length = 2

2022-11-07 17:05:07 : Estimating Clusters by Sampling, 0 mins elapsed.
2022-11-07 17:05:07 : Running Seurats FindClusters (Stuart et al. Cell 2019), 0 mins elapsed.
2022-11-07 17:05:31 : Finding Nearest Clusters, 0.395 mins elapsed.
2022-11-07 17:05:31 : Assigning Nearest Clusters, 0.396 mins elapsed.
2022-11-07 17:05:32 : Testing Outlier Clusters, 0.411 mins elapsed.
2022-11-07 17:05:32 : Assigning Cluster Names to 7 Clusters, 0.411 mins elapsed.
2022-11-07 17:05:32 : Finished addClusters, 0.411 mins elapsed.
2022-11-07 17:05:32 : Identified 7 Clusters, 16.427 mins elapsed.

2022-11-07 17:05:32 : clusterDF-2, Class = DFrame
DataFrame with 10003 rows and 2 columns
                  cellNames    clusters
                <character> <character>
1     1S#AAACAGCCAGTTTGGC-1          C3
2     1S#AAACCAACACAACCTA-1          C4
3     1S#AAACCAACACCTATAG-1          C4
4     1S#AAACCGAAGCTCCTTA-1          C3
5     1S#AAACCGAAGTCTCACC-1          C3
...                     ...         ...
9999  5M#TTTGGTAAGGCCTAAT-1          C3
10000 5M#TTTGTCCCACCTACGG-1          C3
10001 5M#TTTGTCCCATAATCAC-1          C3
10002 5M#TTTGTGAAGCTAAGTC-1          C4
10003 5M#TTTGTGGCACTGACTA-1          C3

2022-11-07 17:05:32 : Saving LSI Iteration, 16.427 mins elapsed.

2022-11-07 17:05:32 : Save iteration, Class = list

Save iteration$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


Save iteration$matSVD: nRows = 10003, nCols = 30
                           LSI1        LSI2       LSI3       LSI4       LSI5
1S#AAACAGCCAGTTTGGC-1 -42.87428 -5.41183352 -4.4779968  0.3131089 -0.8341912
1S#AAACCAACACAACCTA-1 -20.56117  1.71461664  0.7080832 -0.7015296  1.2719265
1S#AAACCAACACCTATAG-1 -12.74008 -0.01721717  0.7608353 -0.4877413  1.0434432
1S#AAACCGAAGCTCCTTA-1 -57.28733 -6.63095081  7.3652403 -7.3549629  5.1005021
1S#AAACCGAAGTCTCACC-1 -12.46349 -0.20085113 -0.5542908  0.1009002  0.2384819


Save iteration$clusters: length = 10003
[1] "C3" "C4" "C4" "C3" "C3" "C3"


Save iteration$nPlot: length = 1
[1] 10000


Save iteration$ArchRProj: length = 1

Save iteration$scaleDims: length = 1
[1] TRUE


Save iteration$corCutOff: length = 1
[1] 0.75


Save iteration$dimsToUse: length = 30
[1] 1 2 3 4 5 6


Save iteration$j: length = 1
[1] 2


Save iteration$threads: length = 1
[1] 6


Save iteration$outDir: length = 1
[1] "/projects/pfenninggroup/singleCell/Pierce_transgen_rat_multiome/data/tidy_data/ArchRProjects/Rat_Transgen_NAc_scATAC/IterativeLSI200_ATAC"


Save iteration$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


2022-11-07 17:06:01 : Creating Cluster Matrix on the total Group Features, 16.915 mins elapsed.
2022-11-07 17:07:54 : Computing Variable Features, 18.794 mins elapsed.
###########
2022-11-07 17:07:54 : Running LSI (3 of 4) on Variable Features, 18.801 mins elapsed.
###########
2022-11-07 17:07:54 : Sampling Cells (N = 10003) for Estimated LSI, 18.802 mins elapsed.
2022-11-07 17:07:54 : Creating Sampled Partial Matrix, 18.802 mins elapsed.
2022-11-07 17:09:31 : Computing Estimated LSI (projectAll = FALSE), 20.408 mins elapsed.

2022-11-07 17:09:31 : LSI Parameters, Class = list

LSI Parameters$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


LSI Parameters$mat: nRows = 200000, nCols = 10003
LSI Parameters$mat: NonZeroEntries = 36417509, EntryRange = [ 1 , 1 ]
5 x 5 sparse Matrix of class "dgCMatrix"
     1S#AAACAGCCAGTTTGGC-1 1S#AAACCAACACAACCTA-1 1S#AAACCAACACCTATAG-1
[1,]                     .                     .                     .
[2,]                     .                     .                     .
[3,]                     .                     .                     .
[4,]                     .                     .                     1
[5,]                     .                     .                     .
     1S#AAACCGAAGCTCCTTA-1 1S#AAACCGAAGTCTCACC-1
[1,]                     1                     .
[2,]                     .                     .
[3,]                     .                     .
[4,]                     .                     .
[5,]                     .                     .


LSI Parameters$LSIMethod: length = 1
[1] 2


LSI Parameters$scaleTo: length = 1
[1] 20000


LSI Parameters$nDimensions: length = 1
[1] 30


LSI Parameters$binarize: length = 1
[1] TRUE


LSI Parameters$outlierQuantiles: length = 2
[1] 0.02 0.98


LSI Parameters$seed: length = 1
[1] 1


LSI Parameters$verbose: length = 1
[1] FALSE


LSI Parameters$tstart: length = 1
[1] "2022-11-07 16:49:06 EST"


LSI Parameters$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


2022-11-07 17:09:31 : Running LSI, Input Matrix = 0.438 GB, 20.419 mins elapsed.
2022-11-07 17:09:31 : Binarizing Matrix, 20.419 mins elapsed.
2022-11-07 17:09:32 : Computing Term Frequency, 20.432 mins elapsed.
2022-11-07 17:09:32 : Filtering Outliers Based On Counts, 20.436 mins elapsed.
2022-11-07 17:09:34 : Removing 0 Sum Rows, 20.461 mins elapsed.
2022-11-07 17:09:38 : Computing Inverse Document Frequency, 20.526 mins elapsed.
2022-11-07 17:09:42 : Computing SVD using irlba, 20.589 mins elapsed.
2022-11-07 17:13:36 : Projecting Outliers with LSI-Projection (Granja* et al 2019), 24.491 mins elapsed.

2022-11-07 17:13:36 : LSI-Projection Parameters, Class = list

LSI-Projection Parameters$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


LSI-Projection Parameters$mat: nRows = 200000, nCols = 50
LSI-Projection Parameters$mat: NonZeroEntries = 61555, EntryRange = [ 1 , 1 ]
5 x 5 sparse Matrix of class "dgCMatrix"
     1S#AAACAGCCAGTTTGGC-1 1S#AAACCAACACAACCTA-1 1S#AAACCAACACCTATAG-1
[1,]                     .                     .                     .
[2,]                     .                     .                     .
[3,]                     .                     .                     .
[4,]                     .                     .                     1
[5,]                     .                     .                     .
     1S#AAACCGAAGCTCCTTA-1 1S#AAACCGAAGTCTCACC-1
[1,]                     1                     .
[2,]                     .                     .
[3,]                     .                     .
[4,]                     .                     .
[5,]                     .                     .


LSI-Projection Parameters$matSVD: nRows = 9600, nCols = 30
                           LSI1        LSI2       LSI3        LSI4        LSI5
1S#AAACAGCCAGTTTGGC-1 -42.98193  5.91993904 -4.2540534 -0.01922206 -1.00700205
1S#AAACCAACACAACCTA-1 -20.63475 -1.25298417  1.0550409  0.43371942  0.86193311
1S#AAACCAACACCTATAG-1 -12.58033 -0.06134291  0.1735289 -0.04141106  1.27759602
1S#AAACCGAAGCTCCTTA-1 -57.08332  6.02130863  6.8154784  3.76468671  7.29438935
1S#AAACCGAAGTCTCACC-1 -12.47843  0.42019113 -0.4917544  0.01205458  0.08794159


LSI-Projection Parameters$returnModel: length = 1
[1] FALSE


LSI-Projection Parameters$verbose: length = 1
[1] FALSE


LSI-Projection Parameters$tstart: length = 0
NULL


LSI-Projection Parameters$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


2022-11-07 17:13:36 : Projecting LSI, Input Matrix = 0.001 GB, 0 mins elapsed.
2022-11-07 17:13:36 : Subsetting by Non-Zero features in inital Matrix, 0 mins elapsed.
2022-11-07 17:13:36 : Binarizing Matrix, 0 mins elapsed.
2022-11-07 17:13:36 : Computing Term Frequency, 0.001 mins elapsed.
2022-11-07 17:13:36 : Computing Inverse Document Frequency, 0.001 mins elapsed.
2022-11-07 17:13:36 : Computing TF-IDF Matrix, 0.002 mins elapsed.
2022-11-07 17:13:37 : Calculating V Matrix, 0.014 mins elapsed.
2022-11-07 17:13:37 : Computing Projected Coordinates, 0.015 mins elapsed.

2022-11-07 17:13:37 : LSI-Projection Parameters, Class = list

LSI-Projection Parameters$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


LSI-Projection Parameters$mat: nRows = 200000, nCols = 403
LSI-Projection Parameters$mat: NonZeroEntries = 2708326, EntryRange = [ 1 , 1 ]
5 x 5 sparse Matrix of class "dgCMatrix"
     1S#AAACGCGCAATTGCGC-1 1S#AAACGTACAACCGCCA-1 1S#AAAGGAGCAGGCCATT-1
[1,]                     .                     .                     .
[2,]                     .                     .                     .
[3,]                     .                     .                     .
[4,]                     .                     .                     .
[5,]                     .                     .                     .
     1S#AAAGGCTCAACTAGAA-1 1S#AAATGCCTCCATAAGC-1
[1,]                     .                     .
[2,]                     .                     .
[3,]                     .                     .
[4,]                     .                     .
[5,]                     .                     .


LSI-Projection Parameters$matSVD: nRows = 9600, nCols = 30
                           LSI1        LSI2       LSI3        LSI4        LSI5
1S#AAACAGCCAGTTTGGC-1 -42.98193  5.91993904 -4.2540534 -0.01922206 -1.00700205
1S#AAACCAACACAACCTA-1 -20.63475 -1.25298417  1.0550409  0.43371942  0.86193311
1S#AAACCAACACCTATAG-1 -12.58033 -0.06134291  0.1735289 -0.04141106  1.27759602
1S#AAACCGAAGCTCCTTA-1 -57.08332  6.02130863  6.8154784  3.76468671  7.29438935
1S#AAACCGAAGTCTCACC-1 -12.47843  0.42019113 -0.4917544  0.01205458  0.08794159


LSI-Projection Parameters$returnModel: length = 1
[1] FALSE


LSI-Projection Parameters$verbose: length = 1
[1] FALSE


LSI-Projection Parameters$tstart: length = 0
NULL


LSI-Projection Parameters$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


2022-11-07 17:13:37 : Projecting LSI, Input Matrix = 0.033 GB, 0 mins elapsed.
2022-11-07 17:13:37 : Subsetting by Non-Zero features in inital Matrix, 0 mins elapsed.
2022-11-07 17:13:37 : Binarizing Matrix, 0.001 mins elapsed.
2022-11-07 17:13:37 : Computing Term Frequency, 0.002 mins elapsed.
2022-11-07 17:13:37 : Computing Inverse Document Frequency, 0.003 mins elapsed.
2022-11-07 17:13:37 : Computing TF-IDF Matrix, 0.003 mins elapsed.
2022-11-07 17:13:38 : Calculating V Matrix, 0.017 mins elapsed.
2022-11-07 17:13:38 : Computing Projected Coordinates, 0.022 mins elapsed.
2022-11-07 17:13:38 : Finished LSI (TF-IDF SVD) using irlba, 24.53 mins elapsed.

2022-11-07 17:13:39 : outLSI-3, Class = SimpleList

outLSI-3$matSVD: nRows = 10003, nCols = 30
                           LSI1        LSI2       LSI3        LSI4        LSI5
1S#AAACAGCCAGTTTGGC-1 -42.98193  5.91993904 -4.2540534 -0.01922206 -1.00700205
1S#AAACCAACACAACCTA-1 -20.63475 -1.25298417  1.0550409  0.43371942  0.86193311
1S#AAACCAACACCTATAG-1 -12.58033 -0.06134291  0.1735289 -0.04141106  1.27759602
1S#AAACCGAAGCTCCTTA-1 -57.08332  6.02130863  6.8154784  3.76468671  7.29438935
1S#AAACCGAAGTCTCACC-1 -12.47843  0.42019113 -0.4917544  0.01205458  0.08794159


outLSI-3$rowSm: length = 200000
[1] 184 477 179 496 349 103


outLSI-3$nCol: length = 1
[1] 9600


outLSI-3$exclude: length = 0
NULL


outLSI-3$idx: length = 200000
[1] 1 2 3 4 5 6


outLSI-3$u: nRows = 200000, nCols = 30
             [,1]          [,2]          [,3]          [,4]          [,5]
[1,] -0.002146957 -0.0008472986  0.0005713415  0.0018356437  0.0022519084
[2,] -0.004551650 -0.0024163008 -0.0043032479 -0.0008669017  0.0001481671
[3,] -0.002136922 -0.0017260437 -0.0007867742 -0.0005168564 -0.0017223424
[4,] -0.004773662 -0.0029697249 -0.0019834502 -0.0026439987 -0.0021725373
[5,] -0.003608853  0.0001031427  0.0017127572 -0.0037437712  0.0019166127


outLSI-3$v: nRows = 9600, nCols = 30
             [,1]          [,2]          [,3]          [,4]          [,5]
[1,] -0.007750791  5.476684e-03 -0.0061713135 -3.180954e-05 -0.0017236619
[2,] -0.003720996 -1.159167e-03  0.0015305374  7.177386e-04  0.0014753508
[3,] -0.002268570 -5.674986e-05  0.0002517367 -6.852890e-05  0.0021868312
[4,] -0.010293647  5.570463e-03  0.0098871475  6.229975e-03  0.0124856358
[5,] -0.002250195  3.887293e-04 -0.0007133833  1.994847e-05  0.0001505276


outLSI-3$binarize: length = 1
[1] TRUE


outLSI-3$scaleTo: length = 1
[1] 20000


outLSI-3$nDimensions: length = 1
[1] 30


outLSI-3$LSIMethod: length = 1
[1] 2


outLSI-3$outliers: length = 403
[1] "1S#AAACGCGCAATTGCGC-1" "1S#AAACGTACAACCGCCA-1" "1S#AAAGGAGCAGGCCATT-1"
[4] "1S#AAAGGCTCAACTAGAA-1" "1S#AAATGCCTCCATAAGC-1" "1S#AACATCATCACGTTAA-1"


outLSI-3$date: length = 1
[1] "2022-11-07"


outLSI-3$seed: length = 1
[1] 1


outLSI-3$scaleDims: length = 1
[1] TRUE


outLSI-3$useMatrix: length = 1
[1] "TileMatrix"


outLSI-3$tileSize: length = 1
[1] 500



2022-11-07 17:13:39 : Cluster Params, Class = list

Cluster Params$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


Cluster Params$matSVD: nRows = 10003, nCols = 30
                           LSI1        LSI2       LSI3        LSI4        LSI5
1S#AAACAGCCAGTTTGGC-1 -42.98193  5.91993904 -4.2540534 -0.01922206 -1.00700205
1S#AAACCAACACAACCTA-1 -20.63475 -1.25298417  1.0550409  0.43371942  0.86193311
1S#AAACCAACACCTATAG-1 -12.58033 -0.06134291  0.1735289 -0.04141106  1.27759602
1S#AAACCGAAGCTCCTTA-1 -57.08332  6.02130863  6.8154784  3.76468671  7.29438935
1S#AAACCGAAGTCTCACC-1 -12.47843  0.42019113 -0.4917544  0.01205458  0.08794159


Cluster Params$corCutOff: length = 1
[1] 0.75


Cluster Params$dimsToUse: length = 30
[1] 1 2 3 4 5 6


Cluster Params$scaleDims: length = 1
[1] TRUE


Cluster Params$verbose: length = 1
[1] TRUE


Cluster Params$j: length = 1
[1] 3


Cluster Params$filterBias: length = 1
[1] TRUE


Cluster Params$cellNames: length = 43786
[1] "1S#AGAAGGTGTTGTTCAC-1" "1S#AAGCCTGTCTTAGGGT-1" "1S#TAATGGTGTCATGCAA-1"
[4] "1S#ACTTGAATCGGTTCCT-1" "1S#GGCTTCAAGCAAACCT-1" "1S#TAGGCTTAGGAGCATA-1"


Cluster Params$cellDepth: length = 43786
1S#AGAAGGTGTTGTTCAC-1 1S#AAGCCTGTCTTAGGGT-1 1S#TAATGGTGTCATGCAA-1 
             4.997448              4.993114              4.985853 
1S#ACTTGAATCGGTTCCT-1 1S#GGCTTCAAGCAAACCT-1 1S#TAGGCTTAGGAGCATA-1 
             4.980140              4.973599              4.967576 


Cluster Params$tstart: length = 1
[1] "2022-11-07 16:49:06 EST"


Cluster Params$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


2022-11-07 17:13:39 : Identifying Clusters, 24.544 mins elapsed.

2022-11-07 17:13:39 : addClusters Input-Parameters, Class = list

addClusters Input-Parameters$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


addClusters Input-Parameters$input: nRows = 10003, nCols = 30
                           LSI1       LSI2        LSI3      LSI4       LSI5
1S#AAACAGCCAGTTTGGC-1 -5.151550  0.9635262 -0.30871020 0.2208466 0.09732677
1S#AAACCAACACAACCTA-1 -5.234651 -0.1880999  0.41285495 0.2510776 0.36257428
1S#AAACCAACACCTATAG-1 -5.135553  0.1344719  0.23334412 0.1428624 0.69811495
1S#AAACCGAAGCTCCTTA-1 -5.108950  0.6010699  0.67293037 0.3968796 0.71626460
1S#AAACCGAAGTCTCACC-1 -5.163000  0.3436030 -0.04571931 0.1693638 0.20176100


addClusters Input-Parameters$reducedDims: length = 1
[1] "IterativeLSI"


addClusters Input-Parameters$name: length = 1
[1] "Clusters"


addClusters Input-Parameters$sampleCells: length = 1
[1] 10000


addClusters Input-Parameters$seed: length = 1
[1] 1


addClusters Input-Parameters$method: length = 1
[1] "Seurat"


addClusters Input-Parameters$dimsToUse: length = 0
NULL


addClusters Input-Parameters$scaleDims: length = 0
NULL


addClusters Input-Parameters$corCutOff: length = 1
[1] 0.75


addClusters Input-Parameters$knnAssign: length = 1
[1] 10


addClusters Input-Parameters$nOutlier: length = 1
[1] 5


addClusters Input-Parameters$maxClusters: length = 1
[1] 25


addClusters Input-Parameters$testBias: length = 1
[1] TRUE


addClusters Input-Parameters$filterBias: length = 1
[1] TRUE


addClusters Input-Parameters$biasClusters: length = 1
[1] 0.01


addClusters Input-Parameters$biasCol: length = 1
[1] "nFrags"


addClusters Input-Parameters$biasVals: length = 10003
[1] 4.068965 3.796019 3.533391 4.494600 3.505286 3.622214


addClusters Input-Parameters$biasQuantiles: length = 2
[1] 0.05 0.95


addClusters Input-Parameters$biasEnrich: length = 1
[1] 10


addClusters Input-Parameters$biasProportion: length = 1
[1] 0.5


addClusters Input-Parameters$biasPval: length = 1
[1] 0.05


addClusters Input-Parameters$nPerm: length = 1
[1] 500


addClusters Input-Parameters$prefix: length = 1
[1] "C"


addClusters Input-Parameters$ArchRProj: length = 0
NULL


addClusters Input-Parameters$verbose: length = 1
[1] FALSE


addClusters Input-Parameters$tstart: length = 0
NULL


addClusters Input-Parameters$force: length = 1
[1] FALSE


addClusters Input-Parameters$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


addClusters Input-Parameters$...: length = 2

2022-11-07 17:13:39 : Estimating Clusters by Sampling, 0 mins elapsed.
2022-11-07 17:13:39 : Running Seurats FindClusters (Stuart et al. Cell 2019), 0 mins elapsed.
2022-11-07 17:14:03 : Finding Nearest Clusters, 0.392 mins elapsed.
2022-11-07 17:14:03 : Assigning Nearest Clusters, 0.393 mins elapsed.
2022-11-07 17:14:04 : Testing Outlier Clusters, 0.408 mins elapsed.
2022-11-07 17:14:04 : Assigning Cluster Names to 7 Clusters, 0.408 mins elapsed.
2022-11-07 17:14:04 : Finished addClusters, 0.408 mins elapsed.
2022-11-07 17:14:04 : Identified 7 Clusters, 24.954 mins elapsed.

2022-11-07 17:14:04 : clusterDF-3, Class = DFrame
DataFrame with 10003 rows and 2 columns
                  cellNames    clusters
                <character> <character>
1     1S#AAACAGCCAGTTTGGC-1          C3
2     1S#AAACCAACACAACCTA-1          C4
3     1S#AAACCAACACCTATAG-1          C4
4     1S#AAACCGAAGCTCCTTA-1          C3
5     1S#AAACCGAAGTCTCACC-1          C3
...                     ...         ...
9999  5M#TTTGGTAAGGCCTAAT-1          C3
10000 5M#TTTGTCCCACCTACGG-1          C2
10001 5M#TTTGTCCCATAATCAC-1          C3
10002 5M#TTTGTGAAGCTAAGTC-1          C4
10003 5M#TTTGTGGCACTGACTA-1          C3

2022-11-07 17:14:04 : Saving LSI Iteration, 24.954 mins elapsed.

2022-11-07 17:14:04 : Save iteration, Class = list

Save iteration$: length = 1
                       
1 function (name)      
2 .Internal(args(name))


Save iteration$matSVD: nRows = 10003, nCols = 30
                           LSI1        LSI2       LSI3        LSI4        LSI5
1S#AAACAGCCAGTTTGGC-1 -42.98193  5.91993904 -4.2540534 -0.01922206 -1.00700205
1S#AAACCAACACAACCTA-1 -20.63475 -1.25298417  1.0550409  0.43371942  0.86193311
1S#AAACCAACACCTATAG-1 -12.58033 -0.06134291  0.1735289 -0.04141106  1.27759602
1S#AAACCGAAGCTCCTTA-1 -57.08332  6.02130863  6.8154784  3.76468671  7.29438935
1S#AAACCGAAGTCTCACC-1 -12.47843  0.42019113 -0.4917544  0.01205458  0.08794159


Save iteration$clusters: length = 10003
[1] "C3" "C4" "C4" "C3" "C3" "C3"


Save iteration$nPlot: length = 1
[1] 10000


Save iteration$ArchRProj: length = 1

Save iteration$scaleDims: length = 1
[1] TRUE


Save iteration$corCutOff: length = 1
[1] 0.75


Save iteration$dimsToUse: length = 30
[1] 1 2 3 4 5 6


Save iteration$j: length = 1
[1] 3


Save iteration$threads: length = 1
[1] 6


Save iteration$outDir: length = 1
[1] "/projects/pfenninggroup/singleCell/Pierce_transgen_rat_multiome/data/tidy_data/ArchRProjects/Rat_Transgen_NAc_scATAC/IterativeLSI200_ATAC"


Save iteration$logFile: length = 1
[1] "ArchRLogs/ArchR-addIterativeLSI-4cfb902ee1f-Date-2022-11-07_Time-16-49-00.log"


